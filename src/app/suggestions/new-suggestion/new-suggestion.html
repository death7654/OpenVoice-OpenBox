<div class="container-fluid p-4">
  <h3 class="fw-semibold mb-4">📝 Create a New Suggestion</h3>

  <form (ngSubmit)="submit()" class="card shadow-sm border-0">
    <div class="card-body">
      <!-- Title -->
      <div class="mb-3">
        <input
          type="text"
          class="form-control form-control-lg fw-semibold"
          placeholder="Title – e.g., Improve dark mode contrast"
          [(ngModel)]="title"
          name="title"
          required
        />
      </div>

      <!-- Category Dropdown -->
      <div class="mb-3">
        <label class="fw-semibold">Category</label>
        <select
          class="form-select"
          [(ngModel)]="selectedCategory"
          name="category"
          required
        >
          <option value="" disabled selected>Select category</option>
          <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
        </select>
      </div>

      <!-- Markdown Formatting Buttons -->
      <div class="mb-2">
        <button type="button" class="btn btn-outline-secondary btn-sm me-2" (click)="formatMarkdown('bold')">B</button>
        <button type="button" class="btn btn-outline-secondary btn-sm me-2" (click)="formatMarkdown('italic')">I</button>
        <button type="button" class="btn btn-outline-secondary btn-sm me-2" (click)="sizeUp()">A+</button>
        <button type="button" class="btn btn-outline-secondary btn-sm me-2" (click)="sizeDown()">A-</button>
      </div>

      <!-- Markdown Editor Tabs -->
      <ul class="nav nav-tabs mb-2">
        <li class="nav-item">
          <button type="button" class="nav-link" [class.active]="!preview" (click)="preview = false">Write</button>
        </li>
        <li class="nav-item">
          <button type="button" class="nav-link" [class.active]="preview" (click)="preview = true">Preview</button>
        </li>
      </ul>

      <!-- Write Tab -->
      <div *ngIf="!preview">
        <textarea
          class="form-control mb-2"
          [style.fontSize.px]="fontSize"
          rows="10"
          [(ngModel)]="description"
          name="description"
          placeholder="Describe your suggestion (Markdown supported)..."
        ></textarea>
        <small class="text-muted">Supports **Markdown** formatting.</small>
      </div>

      <!-- Preview Tab -->
      <div *ngIf="preview" class="border rounded p-3 bg-light">
        <markdown [data]="description || '*Nothing to preview yet...*'"></markdown>
      </div>

      <!-- Tags -->
      <div class="mt-3">
        <label class="fw-semibold">Tags</label>
        <div class="d-flex flex-wrap gap-2 mb-2">
          <span
            class="badge bg-primary text-white px-3 py-2"
            *ngFor="let tag of parsedTags; let i = index"
          >
            {{ tag }}
            <button
              type="button"
              class="btn-close btn-close-white btn-sm ms-2"
              aria-label="Remove"
              (click)="removeTag(i)"
            ></button>
          </span>
        </div>
        <input
          type="text"
          class="form-control"
          placeholder="Type a tag and press Enter"
          [(ngModel)]="tagInput"
          name="tagInput"
        />
      </div>

      <!-- Submit -->
      <div class="d-flex justify-content-end mt-4">
        <button type="submit" class="btn btn-success px-4">💾 Submit Suggestion</button>
      </div>
    </div>
  </form>
</div>
